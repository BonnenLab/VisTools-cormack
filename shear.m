function y = shear(x, n)%% SHEAR 	successively offset rows of an array%			or an array-nee-vector.  Useful for %			making space-time diagrams.%% usage:%	SHEAR(X, N) shears the rows of X by N elements per row.%	If X is a vector, it is expanded into a square array and%			then sheared.%     % see also: roll, turn, shift% % Lawrence K. Cormack% history:% 10/25/00  lkc Wrote it.% 7/4/02    lkc changed name from "autoturn()"% 7/4/02    lkc Cleaned up the comments.% 7/4/02    lkc added second argument (variable shear)% 5/24/11   lkc no longer considers short dimension as the rows% 01/16/13  lkc shift less than 1 now possiblestep = 1;if nargin == 1, n = 1; end;% make vectors into arrays[r c] = size(x);if r == 1	x = repmat(x, c, 1);elseif c==1	x = repmat(x', r, 1);end	% if requested shift is less then one, shift by 1 every 1/shift rowsif n<1    step = round(1/n);    n = 1;endfprintf('shear: approximating as a shift of %1.3f pixels per row\n', 1/step); fprintf('(i.e. 1 pixel every %i rows.) \n', step);for i = 1:step:r-step+1    x(i:i+step-1,:) = turn(x(i:i+step-1,:),(n*round(i/step)));endy=x;